[
   {
      "partnerAction":"identifyUser",
      "name":"Identify User",
      "enabled":true,
      "mapping":{
         "user_id":{
            "@path":"$.userId"
         },
         "device_id":{
            "@if":{
               "exists":{
                  "@path":"$.context.device.id"
               },
               "then":{
                  "@path":"$.context.device.id"
               },
               "else":{
                  "@path":"$.anonymousId"
               }
            }
         },
         "user_properties":{
            "@path":"$.traits"
         },
         "app_version":{
            "@path":"$.context.app.version"
         },
         "platform":{
            "@path":"$.context.device.type"
         },
         "os_name":{
            "@path":"$.context.os.name"
         },
         "os_version":{
            "@path":"$.context.os.version"
         },
         "device_brand":{
            "@path":"$.context.device.brand"
         },
         "device_manufacturer":{
            "@path":"$.context.device.manufacturer"
         },
         "device_model":{
            "@path":"$.context.device.model"
         },
         "carrier":{
            "@path":"$.context.network.carrier"
         },
         "country":{
            "@path":"$.context.location.country"
         },
         "region":{
            "@path":"$.context.location.region"
         },
         "city":{
            "@path":"$.context.location.city"
         },
         "language":{
            "@path":"$.context.locale"
         }
      },
      "subscribe":"type = \"identify\""
   },
   {
      "partnerAction":"trackUser",
      "name":"Track User",
      "enabled":true,
      "mapping":{
         "user_id":{
            "@path":"$.userId"
         },
         "device_id":{
            "@if":{
               "exists":{
                  "@path":"$.context.device.id"
               },
               "then":{
                  "@path":"$.context.device.id"
               },
               "else":{
                  "@path":"$.anonymousId"
               }
            }
         },
         "event_type":{
            "@path":"$.event"
         },
         "time":{
            "@path":"$.timestamp"
         },
         "event_properties":{
            "@path":"$.properties"
         },
         "user_properties":{
            "@path":"$.traits"
         },
         "app_version":{
            "@path":"$.context.app.version"
         },
         "platform":{
            "@path":"$.context.device.type"
         },
         "os_name":{
            "@path":"$.context.os.name"
         },
         "os_version":{
            "@path":"$.context.os.version"
         },
         "device_brand":{
            "@path":"$.context.device.brand"
         },
         "device_manufacturer":{
            "@path":"$.context.device.manufacturer"
         },
         "device_model":{
            "@path":"$.context.device.model"
         },
         "carrier":{
            "@path":"$.context.network.carrier"
         },
         "country":{
            "@path":"$.context.location.country"
         },
         "region":{
            "@path":"$.context.location.region"
         },
         "city":{
            "@path":"$.context.location.city"
         },
         "language":{
            "@path":"$.context.locale"
         },
         "price":{
            "@path":"$.properties.price"
         },
         "quantity":{
            "@path":"$.properties.quantity"
         },
         "revenue":{
            "@path":"$.properties.revenue"
         },
         "productId":{
            "@path":"$.properties.productId"
         },
         "revenueType":{
            "@path":"$.properties.revenueType"
         },
         "location_lat":{
            "@path":"$.context.location.latitude"
         },
         "location_lng":{
            "@path":"$.context.location.longitude"
         },
         "ip":{
            "@path":"$.context.ip"
         },
         "idfa":{
            "@if":{
               "exists":{
                  "@path":"$.context.device.advertisingId"
               },
               "then":{
                  "@path":"$.context.device.advertisingId"
               },
               "else":{
                  "@path":"$.context.device.idfa"
               }
            }
         },
         "idfv":{
            "@path":"$.context.device.id"
         },
         "adid":{
            "@if":{
               "exists":{
                  "@path":"$.context.device.advertisingId"
               },
               "then":{
                  "@path":"$.context.device.advertisingId"
               },
               "else":{
                  "@path":"$.context.device.idfa"
               }
            }
         }
      },
      "subscribe":"type = \"track\""
   }
]
